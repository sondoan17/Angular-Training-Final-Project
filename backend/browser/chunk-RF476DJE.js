import{d as R,f as $,i as Y,n as q,o as z,p as S,q as J}from"./chunk-QIEKLVXF.js";import{a as N}from"./chunk-LSASUGUC.js";import{a as V,b as F,c as U,d as A}from"./chunk-XB2NZQ2A.js";import{Ka as G,La as H,U as L,V as O,W as T}from"./chunk-FZHPKERB.js";import{m as k,n as B}from"./chunk-7TL4XPSH.js";import"./chunk-EJJBCPAK.js";import{$c as M,Hb as t,Ib as i,Jb as C,Nb as b,Qb as v,Sb as u,Wc as w,Xc as D,_c as I,cb as s,cc as n,db as p,dc as x,ec as f,kc as E,mc as _,oa as y,rc as j,tc as P,ub as m,xa as g,ya as h,yb as d}from"./chunk-CJYNM3Q3.js";var Q=a=>["/projects",a];function X(a,r){a&1&&(t(0,"div",4),C(1,"mat-spinner",5),i())}function Z(a,r){if(a&1){let e=b();t(0,"div",15)(1,"div",16)(2,"div",17)(3,"h3",18),n(4),i(),t(5,"span",19),n(6,"Owner"),i()(),t(7,"p",20),n(8),i(),t(9,"div",21)(10,"mat-icon",22),n(11,"group"),i(),t(12,"span"),n(13),i()(),t(14,"div",23)(15,"mat-icon",22),n(16,"access_time"),i(),t(17,"span"),n(18),j(19,"date"),i()(),t(20,"div",24)(21,"a",25),n(22,"View Details"),i(),t(23,"div",26)(24,"button",27),v("click",function(){let c=g(e).$implicit,l=u(2);return h(l.editProject(c))}),t(25,"mat-icon",28),n(26,"edit"),i()(),t(27,"button",29),v("click",function(){let c=g(e).$implicit,l=u(2);return h(l.deleteProject(c))}),t(28,"mat-icon",28),n(29,"delete"),i()()()()()()}if(a&2){let e=r.$implicit;s(4),x(e.name),s(4),x(e.description),s(5),f("",e.members.length||0," members"),s(5),f("Created ",P(19,5,e.createdAt,"mediumDate"),""),s(3),d("routerLink",_(8,Q,e._id))}}function ee(a,r){a&1&&(t(0,"p",30),n(1," You haven't created any projects yet. "),i())}function te(a,r){if(a&1&&(t(0,"div",15)(1,"div",16)(2,"div",17)(3,"h3",18),n(4),i(),t(5,"span",31),n(6,"Member"),i()(),t(7,"p",20),n(8),i(),t(9,"div",21)(10,"mat-icon",22),n(11,"group"),i(),t(12,"span"),n(13),i()(),t(14,"div",23)(15,"mat-icon",22),n(16,"access_time"),i(),t(17,"span"),n(18),j(19,"date"),i()(),t(20,"div",24)(21,"a",25),n(22,"View Details"),i()()()()),a&2){let e=r.$implicit;s(4),x(e.name),s(4),x(e.description),s(5),f("",e.members.length||0," members"),s(5),f("Created ",P(19,5,e.createdAt,"mediumDate"),""),s(3),d("routerLink",_(8,Q,e._id))}}function ie(a,r){a&1&&(t(0,"p",30),n(1," You're not a member of any other projects. "),i())}function re(a,r){if(a&1){let e=b();t(0,"div",6)(1,"div",7)(2,"div",8)(3,"h2",9),n(4,"Your Projects"),i(),t(5,"button",10),v("click",function(){g(e);let c=u();return h(c.openCreateProjectDialog())}),n(6," Create New Project "),i()(),t(7,"div",11),m(8,Z,30,10,"div",12),i(),m(9,ee,2,0,"p",13),i(),t(10,"div")(11,"h2",14),n(12,"Projects You're Part Of"),i(),t(13,"div",11),m(14,te,23,10,"div",12),i(),m(15,ie,2,0,"p",13),i()()}if(a&2){let e=u();s(8),d("ngForOf",e.createdProjects),s(),d("ngIf",e.createdProjects.length===0),s(5),d("ngForOf",e.memberProjects),s(),d("ngIf",e.memberProjects.length===0)}}var K=class a{constructor(r,e,o,c){this.dialog=r;this.projectService=e;this.authService=o;this.snackBar=c}createdProjects=[];memberProjects=[];isLoading=!1;ngOnInit(){this.loadUserProjects()}loadUserProjects(){let r=this.authService.getCurrentUserId();if(!r){console.error("No user ID found - redirecting to login");return}this.isLoading=!0,this.projectService.getUserProjects().subscribe({next:e=>{this.createdProjects=e.filter(o=>o.createdBy&&o.createdBy._id===r),this.memberProjects=e.filter(o=>o.createdBy&&o.createdBy._id!==r&&o.members?.some(c=>c._id===r)),this.isLoading=!1},error:e=>{console.error("Error loading user projects:",e),this.snackBar.open("Error loading projects","Close",{duration:3e3}),this.isLoading=!1}})}openCreateProjectDialog(){this.dialog.open(q,{width:"400px"}).afterClosed().subscribe(e=>{e&&(this.isLoading=!0,this.projectService.createProject(e).subscribe({next:()=>{this.loadUserProjects(),this.snackBar.open("Project created successfully","Close",{duration:3e3})},error:o=>{console.error("Error creating project:",o),this.snackBar.open("Error creating project","Close",{duration:3e3}),this.isLoading=!1}}))})}openEditProjectDialog(r){let e=this.dialog.open(S,{width:"400px",data:{project:r}})}deleteProject(r){this.dialog.open(J,{width:"300px",data:{title:"Confirm Delete",message:`Are you sure you want to delete the project "${r.name}"?`}}).afterClosed().subscribe(o=>{o&&(this.isLoading=!0,this.projectService.deleteProject(r._id).subscribe({next:()=>{this.loadUserProjects(),this.snackBar.open("Project deleted successfully","Close",{duration:3e3})},error:c=>{console.error("Error deleting project:",c),this.snackBar.open("Error deleting project","Close",{duration:3e3}),this.isLoading=!1}}))})}editProject(r){this.dialog.open(S,{width:"300px",data:{name:r.name,description:r.description}}).afterClosed().subscribe(o=>{o&&(this.isLoading=!0,this.projectService.updateProject(r._id,o).subscribe({next:c=>{let l=this.createdProjects.findIndex(W=>W._id===c._id);l!==-1&&(this.createdProjects[l]=c),this.loadUserProjects(),this.snackBar.open("Project updated successfully","Close",{duration:3e3})},error:c=>{console.error("Error updating project:",c),this.snackBar.open("Error updating project","Close",{duration:3e3}),this.isLoading=!1}}))})}static \u0275fac=function(e){return new(e||a)(p(Y),p(z),p(N),p(G))};static \u0275cmp=y({type:a,selectors:[["app-dashboard"]],standalone:!0,features:[E],decls:4,vars:2,consts:[[1,"p-4","sm:p-6","bg-gray-100","min-h-screen"],[1,"max-w-full","mx-auto"],["class","flex justify-center items-center min-h-[calc(100vh-64px)]",4,"ngIf"],["class","container mx-auto px-4 py-8",4,"ngIf"],[1,"flex","justify-center","items-center","min-h-[calc(100vh-64px)]"],["diameter","40"],[1,"container","mx-auto","px-4","py-8"],[1,"mb-12"],[1,"flex","flex-col","sm:flex-row","justify-between","items-center","mb-6","sm:mb-8"],[1,"text-2xl","sm:text-3xl","font-bold","text-gray-800","mb-4","sm:mb-0"],["mat-raised-button","","color","primary",1,"w-full","sm:w-auto","bg-blue-600","hover:bg-blue-700","text-white","font-bold","py-2","px-4","sm:px-6","rounded-full","transition","duration-300","ease-in-out","transform","hover:scale-105",3,"click"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-3","xl:grid-cols-4","gap-4","sm:gap-6"],["class","bg-white rounded-xl shadow-lg overflow-hidden transition duration-300 ease-in-out transform hover:scale-105 hover:shadow-xl",4,"ngFor","ngForOf"],["class","text-center text-gray-600 mt-6 sm:mt-8 text-base sm:text-lg",4,"ngIf"],[1,"text-2xl","sm:text-3xl","font-bold","text-gray-800","mb-6","sm:mb-8"],[1,"bg-white","rounded-xl","shadow-lg","overflow-hidden","transition","duration-300","ease-in-out","transform","hover:scale-105","hover:shadow-xl"],[1,"p-4"],[1,"flex","justify-between","items-start","mb-2"],[1,"text-lg","sm:text-xl","font-semibold","text-gray-800","truncate"],[1,"text-xs","bg-blue-100","text-blue-800","px-2","py-1","rounded-full"],[1,"text-sm","text-gray-600","mb-3","line-clamp-2","h-10"],[1,"flex","items-center","text-xs","text-gray-500","mb-2"],[1,"mr-1","text-gray-400","text-base"],[1,"flex","items-center","text-xs","text-gray-500","mb-4"],[1,"flex","justify-between","items-center"],[1,"text-sm","text-blue-600","hover:text-blue-800","font-medium","transition","duration-300","ease-in-out",3,"routerLink"],[1,"space-x-1"],["mat-icon-button","",1,"text-gray-500","hover:text-blue-600","transition","duration-300","ease-in-out",3,"click"],[1,"text-base"],["mat-icon-button","",1,"text-gray-500","hover:text-red-600","transition","duration-300","ease-in-out",3,"click"],[1,"text-center","text-gray-600","mt-6","sm:mt-8","text-base","sm:text-lg"],[1,"text-xs","bg-green-100","text-green-800","px-2","py-1","rounded-full"]],template:function(e,o){e&1&&(t(0,"div",0)(1,"div",1),m(2,X,2,0,"div",2)(3,re,16,4,"div",3),i()()),e&2&&(s(2),d("ngIf",o.isLoading),s(),d("ngIf",!o.isLoading))},dependencies:[M,w,D,I,T,L,O,$,R,F,V,k,B,H,A,U],styles:[".sidenav-container[_ngcontent-%COMP%]{height:100vh}.sidenav[_ngcontent-%COMP%]{width:250px}.content[_ngcontent-%COMP%]{padding:20px}"]})};export{K as DashboardComponent};
